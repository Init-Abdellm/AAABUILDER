@agent kb v1
description: "Knowledge base query agent"
trigger:
  type: http
  method: POST
  path: /kb

secrets:
  - name: OPENAI
    type: env
    value: OPENAI_API_KEY

vars:
  query:
    type: string
    from: input
    required: true
  context:
    type: string
    from: input
    default: ""

steps:
  - id: search
    type: llm
    provider: openai
    model: gpt-4o
    prompt: |
      Based on the following context, answer the user's question:
      
      Context: {context}
      Question: {query}
      
      If no context is provided, answer based on your general knowledge.
    outputs:
      answer: content

outputs:
  result: "{answer}"
@end